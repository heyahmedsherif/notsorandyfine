---
import Layout from '../layouts/Layout.astro';
import LeaderboardEntry from '../components/LeaderboardEntry.astro';
import figures from '../data/public-figures.json';

const champions = figures.filter(f => f.tier === 'champion').sort((a, b) => b.score - a.score);
const silent = figures.filter(f => f.tier === 'silent').sort((a, b) => b.score - a.score);
const enablers = figures.filter(f => f.tier === 'enabler').sort((a, b) => a.score - b.score);
---

<Layout title="Accountability Tracker — #NotSoRandyFine">
  <section class="py-12 bg-white">
    <div class="max-w-4xl mx-auto px-4">
      <h1 class="section-heading">Accountability Tracker</h1>
      <p class="text-gray-600 mb-8 max-w-2xl">
        Tracking how public figures have responded to Randy Fine's hateful rhetoric.
        Who's speaking up? Who's staying silent? Who's enabling?
      </p>

      <!-- Tier filters -->
      <div class="flex flex-wrap gap-2 mb-8">
        <button class="tier-btn active px-4 py-2 rounded-full text-sm font-medium bg-navy-800 text-white transition-all duration-200 hover:-translate-y-0.5" data-tier="all">
          All ({figures.length})
        </button>
        <button class="tier-btn px-4 py-2 rounded-full text-sm font-medium bg-green-100 text-green-700 hover:bg-green-200 transition-all duration-200 hover:-translate-y-0.5" data-tier="champion">
          Champions ({champions.length})
        </button>
        <button class="tier-btn px-4 py-2 rounded-full text-sm font-medium bg-gray-100 text-gray-600 hover:bg-gray-200 transition-all duration-200 hover:-translate-y-0.5" data-tier="silent">
          Silent ({silent.length})
        </button>
        <button class="tier-btn px-4 py-2 rounded-full text-sm font-medium bg-red-100 text-red-700 hover:bg-red-200 transition-all duration-200 hover:-translate-y-0.5" data-tier="enabler">
          Enablers ({enablers.length})
        </button>
      </div>

      <!-- Champions -->
      <div class="mb-8 tier-section rounded-xl overflow-hidden" data-tier="champion">
        <div class="bg-gradient-to-r from-green-50 to-transparent p-4 border-l-4 border-green-500 mb-4 rounded-r-lg">
          <h2 class="text-xl font-bold text-green-700 flex items-center gap-2">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75L11.25 15 15 9.75m-3-7.036A11.959 11.959 0 013.598 6 11.99 11.99 0 003 9.749c0 5.592 3.824 10.29 9 11.623 5.176-1.332 9-6.03 9-11.622 0-1.31-.21-2.571-.598-3.751h-.152c-3.196 0-6.1-1.248-8.25-3.285z" />
            </svg>
            Champions — Speaking Out Against Hate
          </h2>
        </div>
        <div class="space-y-3 stagger-children">
          {champions.map(figure => <LeaderboardEntry {...figure} />)}
        </div>
      </div>

      <!-- Silent -->
      <div class="mb-8 tier-section rounded-xl overflow-hidden" data-tier="silent">
        <div class="bg-gradient-to-r from-gray-100 to-transparent p-4 border-l-4 border-gray-400 mb-4 rounded-r-lg">
          <h2 class="text-xl font-bold text-gray-600 flex items-center gap-2">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" d="M3.98 8.223A10.477 10.477 0 001.934 12C3.226 16.338 7.244 19.5 12 19.5c.993 0 1.953-.138 2.863-.395M6.228 6.228A10.45 10.45 0 0112 4.5c4.756 0 8.773 3.162 10.065 7.498a10.523 10.523 0 01-4.293 5.774M6.228 6.228L3 3m3.228 3.228l3.65 3.65m7.894 7.894L21 21m-3.228-3.228l-3.65-3.65m0 0a3 3 0 10-4.243-4.243m4.242 4.242L9.88 9.88" />
            </svg>
            Silent — Refusing to Take a Stand
          </h2>
        </div>
        <div class="space-y-3 stagger-children">
          {silent.map(figure => <LeaderboardEntry {...figure} />)}
        </div>
      </div>

      <!-- Enablers -->
      <div class="mb-8 tier-section rounded-xl overflow-hidden" data-tier="enabler">
        <div class="bg-gradient-to-r from-red-50 to-transparent p-4 border-l-4 border-red-500 mb-4 rounded-r-lg">
          <h2 class="text-xl font-bold text-red-700 flex items-center gap-2">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" d="M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.008H12v-.008z" />
            </svg>
            Enablers — Defending Hate
          </h2>
        </div>
        <div class="space-y-3 stagger-children">
          {enablers.map(figure => <LeaderboardEntry {...figure} />)}
        </div>
      </div>
    </div>
  </section>
</Layout>

<script>
  const tierBtns = document.querySelectorAll('.tier-btn');
  const sections = document.querySelectorAll('.tier-section');

  tierBtns.forEach(btn => {
    btn.addEventListener('click', () => {
      const tier = btn.getAttribute('data-tier');

      tierBtns.forEach(b => {
        b.classList.remove('bg-navy-800', 'text-white', 'active');
        if (b.getAttribute('data-tier') === 'champion') {
          b.classList.add('bg-green-100', 'text-green-700');
        } else if (b.getAttribute('data-tier') === 'silent') {
          b.classList.add('bg-gray-100', 'text-gray-600');
        } else if (b.getAttribute('data-tier') === 'enabler') {
          b.classList.add('bg-red-100', 'text-red-700');
        }
      });

      btn.classList.add('bg-navy-800', 'text-white', 'active');
      btn.classList.remove('bg-green-100', 'text-green-700', 'bg-gray-100', 'text-gray-600', 'bg-red-100', 'text-red-700');

      sections.forEach(section => {
        const sectionTier = section.getAttribute('data-tier');
        const show = tier === 'all' || sectionTier === tier;
        if (show) {
          (section as HTMLElement).style.display = '';
          (section as HTMLElement).style.opacity = '0';
          (section as HTMLElement).style.transform = 'translateY(8px)';
          requestAnimationFrame(() => {
            (section as HTMLElement).style.transition = 'opacity 0.3s, transform 0.3s';
            (section as HTMLElement).style.opacity = '1';
            (section as HTMLElement).style.transform = 'translateY(0)';
          });
        } else {
          (section as HTMLElement).style.display = 'none';
        }
      });
    });
  });
</script>
